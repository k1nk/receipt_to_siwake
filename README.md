# ブログラムの概要
経費の領収書から弥生会計またはマネーフォワードクラウド会計の仕訳帳でインポート可能な仕訳ファイルを作成します。
* 仕訳の貸方は「現金」となります。

# 使い方
1. 環境の準備
    * 実行するPCの環境変数として、GOOGLE_CLOUD_PROJECT_IDを作成し、その値に、google cloud platformのプロジェクトIDを設定してください。
     詳細は、[「Vertex AI のAPIを使うための下準備」](https://note.com/kenichi_nakatani/n/n91035c588ecd)をご覧ください。

    * Google Gen AI SDKをインストールしてください。
        ```
        pip install -U -q "google-genai"
        ```

2. 入力対象年度の会計ファイル等の準備
    ＜弥生会計＞
    弥生会計の会計ファイルがない場合は、入力対象年度の「個人事業・不動産」の弥生会計のファイルを新規作成しておきます。
    前年に入力をおこなっている場合は、ファイルを繰り越して、入力衣装年度の会計ファイルを準備しておきます。

    ＜マネーフォワードクラウド会計＞
    次期繰越等で、入力の対象となる年度を作成します。

3. 領収書ごとに、１つの画像ファイルしてスキャンします
    画像ファイルは（.png .jpg .jpeg .webp .pdf .heic）のいずれかの形式で保存してください。

4. スキャンした経費の領収書を１つのフォルダにまとめます。

5. プログラム（make_siwake3.py）を実行します。
        ```
        python make_siwake3.py
        ```
    ※Windows環境の場合、distフォルダ内のmake_siwake3.exeダブルクリックして実行することもできます。

6. ４で作成したフォルダを選択します。

7. 仕訳ファイル
    実行が終わると、上記のフォルダの中に、下記の仕訳ファイルが作成されます。
    弥生会計：「siwakeYAYOI<作成日時>.txt」
    マネーフォワードクラウド会計：「siwakeMF<作成日時>.csv」

8. 上記のファイルをエクセル等で開いて、期間外の仕訳が含まれていないか等のチェックを行います。
    期間外の仕訳がある場合は、必要に応じて訂正・削除を行って下さい。
　　
9. 仕訳日記帳（仕訳帳）画面を表示します。

10. 仕訳ファイルのインポート
    ＜弥生会計＞
    * メニューの「ファイル/インポート」を選択します。
    * 「参照」ボタンを押します。
    * 先に作成した、仕訳ファイルを選択します。
    * 画面の指示に従い、インポートをおこないます。（通常の場合は、デフォルトの指定のまま進むので問題ありません。）
    * 仕訳ファイルに問題がなければ、仕訳が取り込まれます。
    * 期間外の仕訳がある等の場合は、インポートのエラーログがディスクトップに作成されます。
    * エラーの内容を確認し、修正等をおこなってから、再度インポートをおこなって下さい。
    * 仕訳の取り込みが完了したら、勘定科目を確認し必要に応じて訂正をおこなって下さい。
    * 取り込みが漏れている領収書等がないか、確認をおこなって下さい。

    ＜マネーフォワードクラウド会計＞
    * 「インポート」ボタンから、「仕訳帳」を選択します。
    * 「仕訳帳(CSVファイル)のインポート」画面で、上記の仕訳ファイルを選択し、インポートを行います。
